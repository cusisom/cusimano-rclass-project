---
title: "Palmer Penguins Analysis"
author: "Daniel Cusimano"
date: "03/30/2023"
output: html_document
---
This is going to be a working process that will ultimately trim a lot of fat along the way (including this explanation). The goal is for me to set up the webpage with the needed stats and images and then to edit by adding text content and removing the template content. 
  
All of the original content will be below my workstream until I am ready to remove it. 
  
This Quarto file loads the cleaned Palmer Penguins data and does some initial analysis. I find this step very helpful for seeing what results you have to work with for your talk or paper/final report. 

Some of what is written below is for you. I would like you to modify this quarto file to produce a document customized for your analysis and written to explain your thinking in your data analysis so feel free to modify as much as you wish. 

It is worth taking a minute to reflect on where we are in the data analysis workflow. The purpose of the previous processing document was to document data cleaning and processing in preparation for analysis. You saw that as part of the cleaning and processing step, we already had to explore the data somewhat to understand how to clean it. In general, as you explore, you find more things that need cleaning. As you clean, you find more to explore. 

# The need to document your workflow

Although we broke our workflow in this project into cleaning and analysis steps, depending on your project, it may be more logical to divide the scripts in other ways. The organization should naturally reflect the workflow. 

In rather clean datasets at times it might make more sense to combine the cleaning and exploring code parts into a single R or Quarto file. _But if you do have real errors to fix, you will want to carefully document cleaning steps_, and probably not redo the cleaning each time you want to get a bit further on your data exploration and analysis. Itʻs a lot of baggage to carry around and also errors might creep in if you are keeping code in your script that you are not actively working on. 

When there are natural breaks in the workflow (i.e., when you close the door on cleaning or on a first analysis), it can be a good idea to have start a new script because once you clean your data, you will have a new starting point for all of your downstream analyses (and not look back at the really raw data, unless you want to change your mind about some of the cleaning - thus the need for keeping an original raw data file and documenting all the steps).  

This can also come up when you have a multi-stage analysis. In very complex analyses, it can make a lot of sense to have separate scripts for major analyses or workflow steps. As always, use your jugement, and be intentional about your organization. Clean organization = clear thinking.  


# Analysis 

If you did a good job in the previous step, you should have a pretty good idea of the structure of the data. 

For this part of the project, develop three questions and use your R skills to answer them. Begin by producing a summary table of the data that could be included in a future paper. You should produce plots or tables and/or statistics or model fits to address your questions. 

# Setup

The setup has mostly remained the same except that I am adding dplyr and various new files paths

```{r }
#| cache = FALSE
knitr::read_chunk('analysiscode.R')
```

Load needed packages and filepaths.  

```{r setup}
#| message: FALSE
#| warning: FALSE
```

Load custom functions. I haven't messed with this mostly because I don't fully understand it. 

```{r functions}
```

Load the data.

```{r loaddata}
```

# Create a summary table

In any paper you should always report a summary of the data. This includes basic statsistics for your data including sample size, counts, and means and standard errors for continuous data. 

Here we will use skimr which produces a summary table, but with more than we want. Letʻs save it as an object so we can grab the elements we want. 

It turns out that the `skim()` function returns a tibble. We can coerce it to a dataframe and use `head()` to see what the column names are and what the data look like. 

```{r, summarize}
```

## Select columns for a final summary table

Letʻs retain only the variable, N, mean, sd, and category counts, but letʻs rename them. Since we will use the SD to compute the stadard error letʻs just rename it as SE now and save a step later.  (Remember the standard error is just the standard deviation/ square root(sample size)). 

Note: The `results="asis"` is an option for `knitr` to layout the the results without the code formatting. Normally output from code chunks has the look of R output. `"asis"` (as in "as is", lol) removes that behavior, so we can lay it out as a typeset table for print. 

```{r summary.table, results="asis"}
```


# Body Mass Distribution
## Interspecific and Intraspecific Varition

We closed out our first project by creating bivariate plots for all of the continuous variables in our dataset. Each of the morhpological data was specifically plotted against body mass to develop an idea of how these features correlated with overall size. This series of plots is designed to summarize that data.

```{r, summary_plots}
```

I am first interested in the size distribution of the Palmer Penguins. I begin by examining the inter- and intraspecific variation in body mass. This is represented in the histogram in the bottom right of the above figure. 

This distribution becomes much clearer with the violin plot below. Besides following the pattern seen in the summary plots where the Gentoo Penguins appear to be outliers, it is interesting to observe a seemingly smaller range in body mass for the Chinstrap relative to the Gentoo and Adelie Penguins. My first question concerns this apparent difference in body mass variation for each species. I explore this question by considering the role of sexual dimorphism. 

A reasonable explanation for the narrower range in body mass for Chinstrap Penguins would that they reflect less sexual size dimorphism than the other two species. To first test the hypothesis that these three species are indeed sexually dimorphic in body mass I replot the data and distribute it by Sex. 

```{r, Dimorphism1}
```

First I need to remove the NA values. 

```{r, subsetting1}
```

Now I can plot. 

```{r, Dimorphism4}
```

The plot shows clear dimorphism with Gentoo Penguins. It also illustrates stronger dimorphism in Adelie than Chinstrap populations but it is more subtle. After determining that the Palmers Penguins are sexually dimorphic, I want to know if the different species differ in the degree of mass specific Sexual Size Dimorphism. 

# Analysis of Sexual Size Dimorphism


To get a better idea of this discrepancy in Body Mass, I want to test the degree of sexual size dimorphism statistically. The goals here are to 1) illustrate that each of these three penguin species is significantly Sexually Dimorphic in body mass and 2) illustrate the relatively lower degree of dimorphism in the Chinstrap penguins. This second point will support the idea of the narrower body mass distribution in Chinstrap penguins reflecting reduced sexual size dimorphism. While this point might be self-evident, it is still interesting to note the correlation between sexual size dimorphism within a species and overall range in body mass.

To support my hypotheses, I first illustrate summary data on the differences in Body Mass and then test the significance of this difference with a Welch's T-test. I replicate this process for each species.

### Adelie Penguins

For the Adelie Penguins I first subset the species and remove NA values. 

#### Summary

With the NA values removed, I first get an idea of the mean size differences between females and males. I installed the *report* package to help me summarize the data.

```{r, Adelie_T-test1}
```

These means seem to pretty clearly indicate sexual dimorphism but I will run it through a Welch's T-test to investigate statistical significance. 

#### T-test
To test the means of each population (Male and Female) I need to filter the population into individual vectors. From there I can test the means through a t-test. 

```{r, Adelie_T-test2}
```

The p-value supports the significance of Sexual Size Dimorphism in Adelie Penguins. I will pay attention to the t-value (-13.126) for comparison with the other species'. 

### Gentoo Penguins 

As noted above, the Gentoo penguins are subjected to the same round of tests as the Adelie penguins. 

#### Summary

```{r, Gentoo_T-test1}
```

This data seems to reflect an even greater degree of dimorphism than seen in Adelie Penguins. Next is the statstical test. 

#### T-test

```{r, Gentoo_T-test2}
```

Just as above, the p-value corroborates the violin plot distribution for Sexual Size Dimorphism. The t-value here (-14.638) is greater than that of Adelie (-13.126).

*(I suggest that the value is greater despite the number actually being smaller. I have very little background in statistics but from what I have gathered, negative and positive values do not weigh on the interpretation of t-values).* 

### Chinstrap Penguins

The final round of tests is run on the Chinstrap Penguins. My assumption is that both the p- and t- values will be smaller than those of the other two species. 

#### Summary

```{r, Chinstrap_T-test1}
```

It's looking like a much narrower size difference.

### T-test
```{r, Chinstrap_T-test2}
```

The Chinstrap data represented here, while still showing a significance in dimorphism, shows a much lower t-value (-5.2077) than the two other species tested.

### Sexual Size Dimorphism Conclusions

It looks like the data supports my assumptions. The Chinstrap Penguins present much differently than the other species in terms of Sexual Dimorphism. Both the p- and t- values noticebly differed. I wanted to test the statistical difference between the t-test results, but I am not sure how to do that and I am too short on time for this assignment to figure it out. Regardless, suggesting that the overall reduced body mass range in Chinstrap Penguins relative to Adelie and Gentoo Penguins as an outcome of reduced sexual dimorphism seems like a plausible explanation. 

# Differentiating between Adelie and Chinstrap penguins on Dream Island

Despite the differences in sexual dimorphism, the Chinstrap and Adelie Penguins seem to cluster closely in body mass. With their geographic overlap on Dream island, my next question concerns the morphological distinction between the two species. I consider whether, with the current available data, I can see the justification for differentiating the two populations as different species. 

In examining photos of the two birds, the phenotypic differences are distinct. As a paleontologists, however, I do not often have the ability to examine soft tissue. Thus, for my own purposes, I'd like to see just how vague physical measurements can be in phylogenetic pursuits. I will acknowledge here that the measurements provided to us here were taken from specimens in the flesh, and so the results of this inquiry will not directly translate to my interests, but it is a starting point. 

This final question seeks to determin if there are proportional differences in Flipper and Culmen dimensions for the two penguin species that might help to differentiate them.

*I will note here that I did not come into this class with a statistics background. This is on the docket for next term. With that said, it seemed like one potential means of answering this question was to run a principal components analysis for each of the morphological variables given but omitting body mass. And so, this became my agenda.*

::: {layout-ncol=2}
![Chinstrap Penguin](Chinstrap.jpg){Width=30%}

![Adelie Penguin](Adelie.jpg){Width=50%}
:::

## Summary Data for Adelie and Chinstrap Penguins

I begin this process by removing Gentoo Penguins from the analysis.

```{r, nogentoo}
```
Before plotting each variable, I wanted to get a broad graphical look at the interspecific variation in the variables I hadn't yet tested. 

This task was accomplished by installing the GGally package. Using GGally, I generated bivariate plots for all morphological variables other than Body Mass.

```{r, Ad~Cs1}
```
From this set of images it looks like the starkest differences between the two penguin species are the Culmen Length and the Flipper Length, with Culmen Depth being fairly negligable. I want to be sure that these figures represent statistically powerful data though and so I run the Principal Components analysis to determine which variables are most significant.

### Principal Components Analysis

```{r, Ad~Cs2}
```

This analysis shows pretty clearly that the most variation is found in pc1 (~77%) with a fairly steep drop with pc2 (~22%) and negligable scores for pc3.

```{r, Ad~Cs3}
```
PC1 illustrates that most of the variation with the sample is found in Flipper Length. Second to that is the distribution of Culmen Length Values. Importantly, it does not seem from this that Culmen Depth factors into the variation within this population. 

Because Culmen Depth is a negligable variable in this analysis, I focus on pc1 and pc2.
The plot shows variation and when demarcating the species, shows distinct groupings. 

```{r, Ad~Cs4}
```
This illustrates that there are distinct proportional differences in Culmen Length and Flipper Length between the two species. Finally, I will run an ANOVA for these variables. 

### Analysis of Variance

My last step is to investigate how much these variables (Culmen Length and Flipper Length) vary by species. I begin with Culmen Length.

#### Culmen Length Variance

My goal is to identify whether the two species are significantly different in Culmen Length. I start by generating an index column for the data. I calculate the mean of the scores for the whole dataset as well. 

```{r, anovaCL1}
```

The next step was to differentiate the mean Culmen Length value for each species under investigation. I worked on this for A LONG time and could not get it to work. I followed the example given in the Univariate Stats lecture, followed notes from an in person meeting with the professor, and followed the instructions from multiple online sources. I altered the code below in many ways but could never get r to generate separate species means. At the end of the day, I had to move forward. This ultimately changes how my plots turned out. 

```{r, anovaCL2}
```
I first plot the data for the whole assemblage. Especially when embedding the variance lines, there is a pretty distinct difference in how the data is clustered. 

```{r, anovaCL3}
```
The next step was to illustrate the species differences. I was successful in showing where the different species lie on the plot but, again, I could not illustrate the differences in Culmen Length mean for each species. 

```{r, anovaCL4}
```

While my plot did not work out quite the way I wanted it to, I was successful in illustrating that the Adelie and Chinstrap penguins significantly differ in the distribution of Culmen Length values.

This is highlighted statistically through the ANOVA below. 

```{r, anovaCL5}
```
I need a lot of work on my statistics knowledge, but it looks like the pr(>F) value supports a statistically significant difference between the two groups. 

#### Flipper Length Variance

The above analysis aligns with what I was expecting from the bivariate plots above and the Principal Components Analysis. The next variable highlighted by the PCA is Flipper Length. This value was said to represnt the most variation in the two species as a singular data set. My goal here is to determine whether the species can be easily differentiated along this range of variation.

I start by attempting to parse out the mean values for Flipper Length for each species. This effort, as in the above analysis, did not work out...and I can't figure out why. 

```{r, anovaFL1}
```

Once again, the means map the same (same for the larger dataset mean) for each species. It believe this is why my plots below will not segment along species means. 

```{r, anovaFL2}
```
I run through the same plotting process for Flipper Length as I did for Culmen Length. 

```{r, anovaFL3}
```
Despite getting the above warning on all of these plots, the analysis in r does not work if I follow the suggestion. Thus, I have to keep the y$"FLipper Length" syntax.

By differentiating the species by line color in the below plot, I could again illustrate each species' relationship with the mean value of Flipper Length. This analysis, however, looks much different than the prior one. While there is a noticable difference in where the species means would lie if differentiated, it is a much smaller difference than with Culmen Length. 

```{r, anovaFL4}
```

I run the ANOVA and still see a significant statistical difference. I need to brush up on my chops a bit and figure out how to interpret this in a way that corroborates my interpretation from the plots. Saying that both of these variables are significantly different in each species is fine, but one variable seems to be clearly more meaningful.

# Conclusion

I would end this analysis by suggesting that besides Sexual Size Dimorphism, the Adelie and Chinstrap penguins can be differentiated through morphometric data by means of examining the Culmen Length. I am assuming here that the difference in flipper length between the two species is more a product of overall size difference (Flipper Length correlating with Body Mass). I know there are additional ways of testing this but that will be a goal for further research.  


```{r, anovaFL5}
```

